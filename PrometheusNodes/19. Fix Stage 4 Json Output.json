[
  {
    "output": {
      "stage": "automated_diagnosis",
      "diagnostics_executed": [
        {
          "target": "infrastructure",
          "type": "infrastructure",
          "commands_run": [
            "KB Troubleshooting: kubectl logs [pod] --previous",
            "KB Troubleshooting: kubectl describe pod [pod]",
            "KB Troubleshooting: kubectl get events --field-selector involvedObject.name=[pod]"
          ],
          "findings": {
            "infrastructure_status": {
              "component": "Unknown",
              "description": "Pod repeatedly crashes after starting",
              "category": "APPLICATION",
              "urgency": "CRITICAL"
            },
            "kb_evidence": {
              "common_causes": [
                "Application bugs",
                "Missing configs/secrets",
                "Resource limits exceeded",
                "Invalid probe settings"
              ],
              "immediate_actions": [
                "Rollback deployment",
                "Increase memory limits",
                "Fix probe configuration",
                "Check secret mounts"
              ],
              "expected_results": [
                "Logs show application errors",
                "RestartCount > 5",
                "OOMKilled/ExitCode in status",
                "FailedScheduling events"
              ]
            },
            "error_logs": [
              {
                "timestamp": "2023-10-15T10:29:18.000Z",
                "level": "Critical",
                "message": "Pod repeatedly crashes after starting",
                "stack_trace": null
              }
            ]
          }
        }
      ],
      "enriched_context": {
        "deployment_info": {
          "name": "",
          "version": "unknown",
          "replicas": "unknown",
          "last_update": "2023-10-15T10:29:18.000Z",
          "update_strategy": "RollingUpdate"
        },
        "recent_changes": [
          {
            "type": "deployment",
            "time": "2023-10-15T10:29:18.000Z",
            "change": "Pod experiencing memory issues",
            "user": "system"
          }
        ],
        "dependencies": {
          "upstream": [],
          "downstream": [
            "prometheus-kube-state-metrics",
            "kube-state-metrics",
            "domain-config-service"
          ],
          "databases": [],
          "external": []
        }
      },
      "diagnostic_summary": {
        "confirmed_issues": [
          {
            "issue": "Pod repeatedly crashes after starting",
            "evidence": [
              "Application bugs",
              "Missing configs/secrets",
              "Resource limits exceeded",
              "Invalid probe settings"
            ],
            "severity": "critical",
            "impact": "Infrastructure component: Pod repeatedly crashes after starting",
            "namespace": "infrastructure",
            "kb_guidance": [
              "Rollback deployment",
              "Increase memory limits",
              "Fix probe configuration",
              "Check secret mounts"
            ]
          }
        ],
        "secondary_issues": []
      },
      "proceed_to_stage5": true,
      "remediation_confidence": 0.85,
      "_context": {},
      "_debug": {
        "nodeType": "Stage 4: Automated Diagnosis",
        "processedAt": "2023-10-15T10:29:18.000Z",
        "contextId": "ctx-1765884958296-sowzfe",
        "contextPreserved": true,
        "receivedFromStage": "Fix Stage 3 Context",
        "stageSequence": "",
        "diagnosticsCount": 1,
        "autoRemediationEnabled": true,
        "actualPodUsed": "N/A (infrastructure alarm)",
        "diagnosticType": "kb-infrastructure",
        "kbFallbackUsed": true,
        "alertName": "Unknown",
        "alertCategory": "APPLICATION",
        "timeRangeUsed": {
          "start": 1765881358,
          "end": 1765884958
        }
      }
    }
  }
]